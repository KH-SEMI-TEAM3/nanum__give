<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="edu.kh.semi.board.model.mapper.NoticeEditMapper">

  <!-- 게시글 작성 -->
    <insert id="boardInsert" useGeneratedKeys="true" parameterType="Board">
        <selectKey order="BEFORE" resultType="_int" keyProperty="boardNo">
            SELECT SEQ_BOARD_NO.NEXTVAL FROM DUAL
        </selectKey>
INSERT INTO "BOARD" (
    BOARD_NO, BOARD_TITLE, BOARD_CONTENT,
    BOARD_WRITE_DATE, BOARD_UPDATE_DATE, READ_COUNT, BOARD_DEL_FL,
    BOARD_CODE, MEMBER_NO
)
VALUES (
    #{boardNo}, #{boardTitle}, #{boardContent},
    DEFAULT, DEFAULT, DEFAULT, DEFAULT,
     #{boardCode}, #{memberNo}
)

    </insert>
    

    <!-- 게시글 수정 -->
    <update id="boardUpdate">
        UPDATE "BOARD" SET
            BOARD_TITLE = #{boardTitle},
            BOARD_CONTENT = #{boardContent}
        WHERE BOARD_CODE = #{boardCode}
          AND BOARD_NO = #{boardNo}
          AND MEMBER_NO = #{memberNo}
    </update>

    <!-- 게시글 삭제 -->
    <update id="boardDelete">
        UPDATE "BOARD" SET
            BOARD_DEL_FL = 'Y'
        WHERE BOARD_CODE = #{boardCode}
          AND BOARD_NO = #{boardNo}
          AND MEMBER_NO = #{memberNo}
    </update>
    
    <!-- 게시글 이미지 삽입 -->
<insert id="insertBoardImage" parameterType="BoardImg">
  INSERT INTO "BOARD_IMG" (
      IMG_NO, IMG_PATH, IMG_ORIGINAL_NAME,
      IMG_RENAME, IMG_ORDER, BOARD_NO
  )
  VALUES (
      SEQ_IMG_NO.NEXTVAL, #{imgPath}, #{imgOriginalName},
      #{imgRename}, #{imgOrder}, #{boardNo}
  )
</insert>

<!-- 게시글 이미지 삭제 (수정 시 기존 이미지 제거) -->
<delete id="deleteBoardImages" parameterType="int">
  DELETE FROM "BOARD_IMG"
  WHERE BOARD_NO = #{boardNo}
</delete>

</mapper>