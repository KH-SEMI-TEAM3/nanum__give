<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>공지게시판 목록</title>

    <link rel="stylesheet" th:href="@{/css/notice/noticeboard.css}" />

    <!-- 공통 CSS/JS -->
    <th:block th:replace="~{common/common}"></th:block>
  </head>

  <body>
    <!-- 헤더 -->
    <th:block th:replace="~{common/header}"></th:block>

    <!-- 게시판 제목 -->
    <div class="board-container">
      <h1 class="board-header">공지 게시판</h1>

      <!-- 게시글 목록 테이블 -->
      <div class="table-area">
        <table class="board-list">
          <thead>
            <tr>
              <th>글번호</th>
              <th>제목</th>
              <th>작성자</th>
              <th>작성일</th>
              <th>조회수</th>
            </tr>
          </thead>

          <tbody>
            <!-- 게시글이 없을 경우 -->
            <th:block th:if="${#lists.isEmpty(noticeBoardList)}">
              <tr>
                <td colspan="5">공지 게시글이 존재하지 않습니다.</td>
              </tr>
            </th:block>

            <!-- 게시글이 있을 경우 -->
            <th:block th:unless="${#lists.isEmpty(noticeBoardList)}">
              <tr th:each="board : ${noticeBoardList}" th:object="${board}">
                <!-- 게시글 번호 -->
                <td th:text="*{boardNo}">1</td>

                <!-- 제목 (상세 페이지 링크 포함) -->
                <td>
                  <!-- 검색 X -->
                  <a
                    th:unless="${param.key}"
                    th:href="@{/notice/{boardNo}(boardNo=*{boardNo}, cp=${pagination.currentPage})}"
                    th:text="*{boardTitle}"
                  >
                    공지 제목</a
                  >

                  <!-- 검색 O -->
                  <a
                    th:if="${param.key}"
                    th:href="@{/notice/{boardNo}(boardNo=*{boardNo}, cp=${pagination.currentPage}, key=${param.key}, query=${param.query})}"
                    th:text="*{boardTitle}"
                  >
                    공지 제목</a
                  >
                </td>

                <!-- 작성자 -->
                <td th:text="*{memberNickname}">관리자</td>

                <!-- 작성일 -->
                <td th:text="*{boardWriteDate}">2025.05.21</td>

                <!-- 조회수 -->
                <td th:text="*{readCount}">0</td>
              </tr>
            </th:block>
          </tbody>
        </table>
      </div>

      <!-- 페이지네이션 영역 -->
      <div
        class="pagination-area"
        th:if="${pagination != null}"
        th:object="${pagination}"
      >
        <!-- 검색 X -->
        <th:block th:unless="${param.key}">
          <!-- 첫 페이지일 경우 숨김 -->
          <a th:if="*{currentPage > 1}" th:href="@{/notice/list(cp=1)}"
            ><button>&laquo;</button></a
          >
          <a
            th:if="*{currentPage > 1}"
            th:href="@{/notice/list(cp=*{prevPage})}"
            ><button>&lt;</button></a
          >

          <th:block th:each="i : *{#numbers.sequence(startPage, endPage)}">
            <a th:if="${i} == *{currentPage}">
              <button class="active" th:text="${i}">1</button>
            </a>
            <a
              th:unless="${i} == *{currentPage}"
              th:href="@{/notice/list(cp=${i})}"
            >
              <button th:text="${i}">1</button>
            </a>
          </th:block>

          <!-- 마지막 페이지일 경우 숨김 -->
          <a
            th:if="*{currentPage < maxPage}"
            th:href="@{/notice/list(cp=*{nextPage})}"
            ><button>&gt;</button></a
          >
          <a
            th:if="*{currentPage < maxPage}"
            th:href="@{/notice/list(cp=*{maxPage})}"
            ><button>&raquo;</button></a
          >
        </th:block>

        <!-- 검색 O -->
        <th:block th:if="${param.key}">
          <!-- 첫 페이지일 경우 숨김 -->
          <a
            th:if="*{currentPage > 1}"
            th:href="@{/notice/list(cp=1, key=${param.key}, query=${param.query})}"
            ><button>&laquo;</button></a
          >
          <a
            th:if="*{currentPage > 1}"
            th:href="@{/notice/list(cp=*{prevPage}, key=${param.key}, query=${param.query})}"
            ><button>&lt;</button></a
          >

          <th:block th:each="i : *{#numbers.sequence(startPage, endPage)}">
            <a th:if="${i} == *{currentPage}">
              <button class="active" th:text="${i}">1</button>
            </a>
            <a
              th:unless="${i} == *{currentPage}"
              th:href="@{/notice/list(cp=${i}, key=${param.key}, query=${param.query})}"
            >
              <button th:text="${i}">1</button>
            </a>
          </th:block>

          <!-- 마지막 페이지일 경우 숨김 -->
          <a
            th:if="*{currentPage < maxPage}"
            th:href="@{/notice/list(cp=*{nextPage}, key=${param.key}, query=${param.query})}"
            ><button>&gt;</button></a
          >
          <a
            th:if="*{currentPage < maxPage}"
            th:href="@{/notice/list(cp=*{maxPage}, key=${param.key}, query=${param.query})}"
            ><button>&raquo;</button></a
          >
        </th:block>
      </div>

      <!-- 검색 영역 -->
      <div class="search-area-wrap">
        <div class="search-area">
          <!-- 보드 리스트 주소와 동일하게 수정 -->
          <form th:action="@{/notice/list}" method="get" class="search-area">
            <select name="key">
              <option value="title" th:selected="${param.key == 'title'}">
                제목
              </option>
              <option value="content" th:selected="${param.key == 'content'}">
                내용
              </option>
            </select>
            <div class="search-input-wrap">
              <input
                type="text"
                name="query"
                placeholder="검색어 입력"
                th:value="${param.query}"
              />
              <button type="submit" class="icon-search">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="16"
                  height="16"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  viewBox="0 0 24 24"
                >
                  <circle cx="11" cy="11" r="8" />
                  <line x1="21" y1="21" x2="16.65" y2="16.65" />
                </svg>
              </button>
            </div>
          </form>
        </div>

        <!-- 글쓰기 버튼 (관리자만 노출) -->
        <div class="button-area">
          <button
            class="write-btn"
            id="insertBtn"
            th:if="${session.loginMember != null and session.loginMember.authority == 0}"
          >
            글쓰기
          </button>
        </div>
      </div>
    </div>

    <script th:src="@{/js/board/notice/noticeList.js}"></script>

    <!-- 푸터 -->
    <th:block th:replace="~{common/footer}"></th:block>

    <!-- 자바스크립트 -->
    <script th:src="@{/js/header.js}"></script>
  </body>
</html>
